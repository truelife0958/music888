<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ²„å¬ - åœ¨çº¿éŸ³ä¹æ’­æ”¾å™¨</title>
    <meta name="description" content="ä¼ä¸šçº§åœ¨çº¿éŸ³ä¹æ’­æ”¾å™¨ - æ”¯æŒ7ä¸ªéŸ³ä¹å¹³å°ã€æ™ºèƒ½æ¨èã€æ‰¹é‡æ“ä½œ">
    <meta name="theme-color" content="#1db954">
    <link rel="icon" type="image/x-icon" href="ytmusic.ico">
    <!-- è€ç‹ä¿®å¤ï¼šPWAåŠŸèƒ½å·²æ¢å¤ -->
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="ytmusic.ico">
    <!-- è€ç‹æ³¨é‡Šï¼šViteä¼šé€šè¿‡main.tsè‡ªåŠ¨æ³¨å…¥CSSï¼Œä¸éœ€è¦æ‰‹åŠ¨å¼•å…¥ -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="bg-animation"></div>
    <div class="bg-overlay"></div>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-music"></i>
                <span>æ²„å¬</span>
            </div>
            <!-- è€ç‹æ–°å¢ï¼šAPIçŠ¶æ€ç›‘æ§æ˜¾ç¤º -->
            <div class="api-status" id="apiStatus">
                <span class="api-indicator api-local"></span>
                <span class="api-name">æ­£åœ¨æ£€æµ‹...</span>
            </div>
            <button class="settings-btn" id="settingsBtn" title="è®¾ç½®">
                <i class="fas fa-cog"></i>
            </button>
            <div class="search-container">
                <form class="search-wrapper" onsubmit="event.preventDefault(); window.triggerSearch && window.triggerSearch(); return false;">
                    <input type="text" class="search-input" placeholder="æœç´¢éŸ³ä¹ã€æ­Œæ‰‹ã€ä¸“è¾‘..." id="searchInput" required>
                    <select class="source-select" id="sourceSelect">
                        <option value="netease">ç½‘æ˜“äº‘éŸ³ä¹</option>
                        <option value="tencent">QQéŸ³ä¹</option>
                    </select>
                    <button type="submit" class="search-btn">
                        <i class="fas fa-search" style="pointer-events: none;"></i>
                    </button>
                </form>
            </div>
        </div>
    </nav>
    <div class="main-container">
        <div class="content-section">
            <div class="tabs">
                <button class="tab-btn active" data-tab="search">
                    <i class="fas fa-search"></i> æœç´¢ç»“æœ
                </button>
                <button class="tab-btn" data-tab="discover">
                    <i class="fas fa-compass"></i> å‘ç°éŸ³ä¹
                </button>
                <button class="tab-btn" data-tab="parse">
                    <i class="fas fa-cloud-download-alt"></i> è§£ææ­Œå•
                </button>
            </div>

            <!-- å‘ç°éŸ³ä¹æ ‡ç­¾ - åªä¿ç•™æ’è¡Œæ¦œ -->
            <div id="discoverTab" class="tab-content">
                <div class="section-header">
                    <h3><i class="fas fa-trophy"></i> æ’è¡Œæ¦œ</h3>
                </div>
                <div id="toplistsGrid"></div>
            </div>
            <div id="parseTab" class="tab-content">
                <!-- æˆ‘ä¿å­˜çš„æ­Œå• -->
                <div class="saved-playlists-container" style="margin-bottom: 15px;">
                    <div class="saved-playlists-header">
                        <h4 style="display: flex; align-items: center; gap: 8px; cursor: pointer; margin: 0;" id="savedPlaylistsHeader">
                            <i class="fas fa-bookmark"></i>
                            æˆ‘ä¿å­˜çš„æ­Œå•
                            <i class="fas fa-chevron-down" id="savedPlaylistsToggleIcon" style="font-size: 12px; color: rgba(255, 255, 255, 0.6);"></i>
                        </h4>
                        <button class="clear-all-btn" id="clearSavedPlaylistsBtn" title="æ¸…ç©ºæ‰€æœ‰æ­Œå•">
                            <i class="fas fa-trash"></i> æ¸…ç©º
                        </button>
                    </div>
                    <div class="saved-playlists-list" id="savedPlaylistsListInParse" style="display: none;">
                        <div class="empty-saved-state">
                            <i class="fas fa-music"></i>
                            <div>æš‚æ— ä¿å­˜çš„æ­Œå•</div>
                            <div style="margin-top: 8px; font-size: 12px; opacity: 0.7;">
                                åœ¨ä¸‹æ–¹è§£ææ­Œå•åä¿å­˜
                            </div>
                        </div>
                    </div>
                </div>

                <div class="playlist-input-container">
                    <select class="playlist-source-select" id="playlistSourceSelect" style="margin-bottom: 10px;">
                        <option value="netease">ç½‘æ˜“äº‘éŸ³ä¹</option>
                        <option value="tencent">QQéŸ³ä¹</option>
                    </select>
                    <input type="text" id="playlistIdInput" class="playlist-input" placeholder="è¾“å…¥æ­Œå•ID (å¦‚: 60198, 3778678) æˆ–é“¾æ¥...">
                    <button class="playlist-btn">
                        <i class="fas fa-download"></i> è§£æ
                    </button>
                </div>
                <div id="currentParsedPlaylist" style="display: none;">
                    <div class="parsed-playlist-header">
                        <div class="parsed-playlist-info">
                            <h3 id="parsedPlaylistName">æ­Œå•åç§°</h3>
                            <p id="parsedPlaylistStats"><i class="fas fa-music"></i> 0é¦–æ­Œæ›²</p>
                        </div>
                        <div class="parsed-playlist-actions">
                            <button class="action-btn-large download-all-btn" title="ä¸‹è½½æ•´ä¸ªæ­Œå•">
                                <i class="fas fa-download"></i> ä¸‹è½½å…¨éƒ¨
                            </button>
                            <button class="action-btn-large save-btn" title="ä¿å­˜åˆ°æˆ‘çš„æ­Œå•">
                                <i class="fas fa-bookmark"></i> ä¿å­˜æ­Œå•
                            </button>
                            <button class="action-btn-large clear-btn" title="æ¸…é™¤å½“å‰è§£æ">
                                <i class="fas fa-times-circle"></i> æ¸…é™¤
                            </button>
                        </div>
                    </div>
                </div>
                <div class="search-results" id="parseResults">
                    <div class="empty-state">
                        <i class="fas fa-cloud-download-alt"></i>
                        <div>è¾“å…¥ç½‘æ˜“äº‘æ­Œå•IDæˆ–é“¾æ¥åç‚¹å‡»è§£ææŒ‰é’®</div>
                        <div style="margin-top: 10px; font-size: 12px; color: rgba(255, 255, 255, 0.5);">
                            æ¨èæµ‹è¯•æ­Œå•ID: <span style="color: #1db954; cursor: pointer;" onclick="document.getElementById('playlistIdInput').value='60198'">60198</span> Â·
                            <span style="color: #1db954; cursor: pointer;" onclick="document.getElementById('playlistIdInput').value='3778678'">3778678</span> Â·
                            <span style="color: #1db954; cursor: pointer;" onclick="document.getElementById('playlistIdInput').value='2884035'">2884035</span>
                        </div>
                    </div>
                </div>
            </div>
            <div id="searchTab" class="tab-content">
                <!-- æ¨èéŸ³ä¹å’Œæ¢ç´¢é›·è¾¾æŒ‰é’® -->
                <div class="discover-section" style="display: flex; gap: 10px; margin-bottom: 20px; padding: 0 20px;">
                    <button class="explore-radar-btn" id="recommendMusicBtn" style="flex: 1;">
                        <i class="fas fa-star"></i>
                        <span>æ¨èéŸ³ä¹</span>
                    </button>
                    <button class="explore-radar-btn" id="exploreRadarBtn" style="flex: 1;">
                        <i class="fas fa-radar"></i>
                        <span>æ¢ç´¢é›·è¾¾</span>
                    </button>
                </div>
                <div class="search-results" id="searchResults">
                    <div class="empty-state">
                        <i class="fas fa-search"></i>
                        <div>åœ¨ä¸Šæ–¹æœç´¢æ¡†è¾“å…¥å…³é”®è¯å¼€å§‹æœç´¢éŸ³ä¹ï¼Œæˆ–ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å‘ç°æ›´å¤šéŸ³ä¹</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ’­æ”¾å™¨åŒºåŸŸ -->
        <div class="player-section">
            <div class="player-content">
                <div class="current-song">
                    <div class="current-cover-container">
                        <img class="current-cover" id="currentCover" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjIwIiBoZWlnaHQ9IjIyMCIgdmlld0JveD0iMCAwIDIyMCAyMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMjAiIGhlaWdodD0iMjIwIiBmaWxsPSJyZ2JhKDI1NSwyNTUsMjU5LDAuMSkiIHJ4PSIyMCIvPgo8cGF0aCBkPSJNMTEwIDcwTDE0MCAxMTBIMTIwVjE1MEg5MFYxMTBINzBMMTEwIDcwWiIgZmlsbD0icmdiYSgyNTUsMjU1LDI1NSwwLjMpIi8+Cjwvc3ZnPgo=" alt="ä¸“è¾‘å°é¢">
                    </div>
                    <div class="current-info">
                        <h3 id="currentTitle">æœªé€‰æ‹©æ­Œæ›²</h3>
                        <p id="currentArtist">è¯·æœç´¢å¹¶é€‰æ‹©è¦æ’­æ”¾çš„æ­Œæ›²</p>
                    </div>
                </div>
                <div class="player-controls">
                    <button class="control-btn small" id="playlistBtn" title="æ’­æ”¾åˆ—è¡¨">
                        <i class="fas fa-list-ul"></i>
                    </button>
                    <button class="control-btn small" id="playerFavoriteBtn" title="æ·»åŠ åˆ°æˆ‘çš„å–œæ¬¢">
                        <i class="far fa-heart"></i>
                    </button>
                    <button class="control-btn small" id="prevBtn" title="ä¸Šä¸€é¦–">
                        <i class="fas fa-step-backward"></i>
                    </button>
                    <button class="control-btn play-btn" id="playBtn">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="control-btn small" id="nextBtn" title="ä¸‹ä¸€é¦–">
                        <i class="fas fa-step-forward"></i>
                    </button>
                    <button class="control-btn small" id="playModeBtn" title="åˆ—è¡¨å¾ªç¯">
                        <i class="fas fa-repeat"></i>
                    </button>
                </div>
                <!-- æ­Œè¯æ˜¾ç¤ºåŒºåŸŸ -->
                <div class="lyrics-container-inline" id="lyricsContainerInline">
                    <div class="lyric-line">æš‚æ— æ­Œè¯</div>
                </div>
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="time-info">
                        <span id="currentTime">0:00</span>
                        <span id="totalTime">0:00</span>
                    </div>
                </div>
                <div class="volume-container">
                    <i class="fas fa-volume-up volume-icon"></i>
                    <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="80">
                </div>
                <div class="quality-download-container">
                    <select class="quality-select" id="qualitySelect">
                        <option value="128">æ ‡å‡† 128K</option>
                        <option value="192">è¾ƒé«˜ 192K</option>
                        <option value="320">é«˜å“è´¨ 320K</option>
                        <option value="740" selected>æ— æŸ FLAC</option>
                        <option value="999">Hi-Res</option>
                    </select>
                    <button class="download-btn" id="downloadSongBtn" disabled>
                        <i class="fas fa-download"></i>
                        <span>ä¸‹è½½éŸ³ä¹</span>
                    </button>
                    <button class="download-btn" id="downloadLyricBtn" disabled>
                        <i class="fas fa-file-text"></i>
                        <span>ä¸‹è½½æ­Œè¯</span>
                    </button>
                </div>
            </div>
            <audio id="audioPlayer" preload="metadata"></audio>
        </div>


        <!-- æˆ‘çš„åŒºåŸŸ -->
        <div class="my-section">
            <h2 class="section-title">
                <i class="fas fa-bookmark"></i> æˆ‘çš„
            </h2>

            <!-- æ’­æ”¾å†å² -->
            <div class="saved-playlists-container" style="margin-bottom: 15px;">
                <div class="saved-playlists-header">
                    <h4 style="display: flex; align-items: center; gap: 8px; margin: 0;">
                        <i class="fas fa-history"></i>
                        æ’­æ”¾å†å²
                    </h4>
                    <button class="clear-all-btn" id="myClearHistoryBtn" title="æ¸…ç©ºæ’­æ”¾å†å²">
                        <i class="fas fa-trash"></i> æ¸…ç©º
                    </button>
                </div>
                <div class="saved-playlists-list" id="myPlayHistoryList" style="display: block;">
                    <div class="empty-saved-state">
                        <i class="fas fa-history"></i>
                        <div>æš‚æ— æ’­æ”¾è®°å½•</div>
                    </div>
                </div>
            </div>

            <!-- æˆ‘çš„å–œæ¬¢ -->
            <div class="saved-playlists-container" style="margin-bottom: 15px;">
                <div class="saved-playlists-header">
                    <h4 style="display: flex; align-items: center; gap: 8px; margin: 0;">
                        <i class="fas fa-heart"></i>
                        æˆ‘çš„å–œæ¬¢
                    </h4>
                    <button class="clear-all-btn" id="myClearFavoritesBtn" title="æ¸…ç©ºæ”¶è—">
                        <i class="fas fa-trash"></i> æ¸…ç©º
                    </button>
                </div>
                <div class="saved-playlists-list" id="myFavoritesList" style="display: block;">
                    <div class="empty-saved-state">
                        <i class="fas fa-heart"></i>
                        <div>æš‚æ— æ”¶è—æ­Œæ›²</div>
                        <div style="margin-top: 8px; font-size: 12px; opacity: 0.7;">
                            ç‚¹å‡»æ’­æ”¾å™¨çš„çˆ±å¿ƒæŒ‰é’®æ”¶è—æ­Œæ›²
                        </div>
                    </div>
                </div>
            </div>

            <div class="search-results" id="myResults">
                <div class="empty-state">
                    <i class="fas fa-hand-pointer"></i>
                    <div>ç‚¹å‡»ä¸Šæ–¹æ’­æ”¾å†å²æˆ–æ”¶è—æŸ¥çœ‹è¯¦æƒ…</div>
                </div>
            </div>
        </div>

        <div class="mobile-page-indicators">
            <div class="page-indicator active" onclick="switchMobilePage(0)"></div>
            <div class="page-indicator" onclick="switchMobilePage(1)"></div>
            <div class="page-indicator" onclick="switchMobilePage(2)"></div>
        </div>
    </div>

    <!-- æ’­æ”¾åˆ—è¡¨å¼¹çª— -->
    <div class="playlist-modal" id="playlistModal">
        <div class="playlist-modal-content">
            <div class="playlist-modal-header">
                <h3><i class="fas fa-list-ul"></i> å½“å‰æ’­æ”¾åˆ—è¡¨</h3>
                <button class="close-modal-btn" id="closePlaylistModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="playlist-modal-body" id="playlistModalBody">
                <div class="empty-state">
                    <i class="fas fa-music"></i>
                    <div>æ’­æ”¾åˆ—è¡¨ä¸ºç©º</div>
                </div>
            </div>
            <div class="playlist-modal-footer">
                <button class="modal-btn" id="clearPlaylistBtn">
                    <i class="fas fa-trash"></i> æ¸…ç©ºåˆ—è¡¨
                </button>
                <button class="modal-btn" id="savePlaylistBtn">
                    <i class="fas fa-save"></i> ä¿å­˜ä¸ºæ­Œå•
                </button>
            </div>
        </div>
    </div>

    <!-- è®¾ç½®é¢æ¿å¼¹çª— -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-modal-content">
            <div class="settings-modal-header">
                <h3><i class="fas fa-cog"></i> è®¾ç½®</h3>
                <button class="close-modal-btn" id="closeSettingsModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="settings-modal-body">
                <!-- APIè®¾ç½® -->
                <div class="settings-section">
                    <div class="settings-section-title">
                        <i class="fas fa-server"></i>
                        <span>APIè®¾ç½®</span>
                    </div>
                    <div class="settings-item">
                        <label for="apiSourceSelect">é»˜è®¤éŸ³ä¹æº</label>
                        <select id="apiSourceSelect" class="settings-select">
                            <option value="netease">ç½‘æ˜“äº‘éŸ³ä¹</option>
                            <option value="tencent">QQéŸ³ä¹</option>
                        </select>
                    </div>
                    <div class="settings-item">
                        <label>
                            <input type="checkbox" id="autoRetryCheckbox" checked>
                            <span>APIå¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•</span>
                        </label>
                    </div>
                </div>

                <!-- ç¼“å­˜ç®¡ç† -->
                <div class="settings-section">
                    <div class="settings-section-title">
                        <i class="fas fa-database"></i>
                        <span>ç¼“å­˜ç®¡ç†</span>
                    </div>
                    <div class="settings-item">
                        <div class="cache-info">
                            <span>ç¼“å­˜å¤§å°:</span>
                            <span id="cacheSize">è®¡ç®—ä¸­...</span>
                        </div>
                    </div>
                    <div class="settings-item">
                        <button class="settings-btn-action" id="clearCacheBtn">
                            <i class="fas fa-trash-alt"></i>
                            æ¸…ç†ç¼“å­˜
                        </button>
                        <button class="settings-btn-action" id="clearAllDataBtn">
                            <i class="fas fa-exclamation-triangle"></i>
                            æ¸…ç©ºæ‰€æœ‰æ•°æ®
                        </button>
                    </div>
                </div>

                <!-- æ’­æ”¾è®¾ç½® -->
                <div class="settings-section">
                    <div class="settings-section-title">
                        <i class="fas fa-play-circle"></i>
                        <span>æ’­æ”¾è®¾ç½®</span>
                    </div>
                    <div class="settings-item">
                        <label>
                            <input type="checkbox" id="autoPlayCheckbox">
                            <span>è‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€é¦–</span>
                        </label>
                    </div>
                    <div class="settings-item">
                        <label>
                            <input type="checkbox" id="showLyricsCheckbox" checked>
                            <span>æ˜¾ç¤ºæ­Œè¯</span>
                        </label>
                    </div>
                </div>

                <!-- å…³äº -->
                <div class="settings-section">
                    <div class="settings-section-title">
                        <i class="fas fa-info-circle"></i>
                        <span>å…³äº</span>
                    </div>
                    <div class="settings-item about-info">
                        <p><strong>æ²„å¬ - åœ¨çº¿éŸ³ä¹æ’­æ”¾å™¨</strong></p>
                        <p>ç‰ˆæœ¬: 2.0.0</p>
                        <p>æ”¯æŒ7ä¸ªéŸ³ä¹å¹³å°ã€æ™ºèƒ½æ¨èã€æ‰¹é‡æ“ä½œ</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="https://github.com/truelife0958/music888" target="_blank" rel="noopener noreferrer">
                    <i class="fab fa-github"></i>
                    <span>GitHub ä»“åº“</span>
                </a>
                <span class="footer-divider">|</span>
                <a href="https://github.com/truelife0958/music888/issues" target="_blank" rel="noopener noreferrer">
                    <i class="fas fa-bug"></i>
                    <span>åé¦ˆé—®é¢˜</span>
                </a>
                <span class="footer-divider">|</span>
                <a href="https://github.com/truelife0958/music888/stargazers" target="_blank" rel="noopener noreferrer">
                    <i class="fas fa-star"></i>
                    <span>Star æ”¯æŒ</span>
                </a>
            </div>
            <div class="footer-info">
                <p>Â© 2025 æ²„å¬ - å¼€æºåœ¨çº¿éŸ³ä¹æ’­æ”¾å™¨</p>
            </div>
        </div>
    </footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <!-- ğŸš¨ ç´§æ€¥ä¿®å¤è„šæœ¬ï¼šç¡®ä¿æœç´¢æŒ‰é’®åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½èƒ½å·¥ä½œ -->
    <script>
        console.log('ğŸ”§ [ç´§æ€¥ä¿®å¤] åŠ è½½æœç´¢æŒ‰é’®ä¿®å¤è„šæœ¬');
        
        // ç«‹å³å®šä¹‰å…¨å±€è§¦å‘å‡½æ•°ï¼ˆé˜²æ­¢è¡¨å•æäº¤æ—¶æ‰¾ä¸åˆ°ï¼‰
        window.triggerSearch = function() {
            console.log('ğŸ¯ [ç´§æ€¥ä¿®å¤] triggerSearchè¢«è°ƒç”¨');
            const input = document.getElementById('searchInput');
            const select = document.getElementById('sourceSelect');
            if (input && input.value.trim()) {
                console.log('âœ… [ç´§æ€¥ä¿®å¤] è§¦å‘æœç´¢:', input.value, select.value);
                // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶ï¼Œè®©main.tsä¸­çš„å¤„ç†å™¨æ¥æ”¶
                const event = new CustomEvent('manualSearch', {
                    detail: { keyword: input.value.trim(), source: select.value }
                });
                document.dispatchEvent(event);
            } else {
                console.warn('âš ï¸ [ç´§æ€¥ä¿®å¤] æœç´¢å…³é”®è¯ä¸ºç©º');
            }
        };
        
        // DOMåŠ è½½å®Œæˆåç«‹å³ç»‘å®š
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ”§ [ç´§æ€¥ä¿®å¤] DOMåŠ è½½å®Œæˆï¼Œå¼€å§‹ç»‘å®šäº‹ä»¶');
            
            const searchBtn = document.querySelector('.search-btn');
            const searchInput = document.getElementById('searchInput');
            const searchWrapper = document.querySelector('.search-wrapper');
            
            if (searchBtn) {
                // æ–¹æ³•1ï¼šç›´æ¥ç‚¹å‡»äº‹ä»¶ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
                searchBtn.addEventListener('click', function(e) {
                    console.log('ğŸ–±ï¸ [ç´§æ€¥ä¿®å¤] æœç´¢æŒ‰é’®è¢«ç‚¹å‡»ï¼ˆç›´æ¥äº‹ä»¶ï¼‰');
                    e.preventDefault();
                    e.stopPropagation();
                    window.triggerSearch();
                }, true); // ä½¿ç”¨æ•è·é˜¶æ®µ
                
                // æ–¹æ³•2ï¼šé¼ æ ‡æŒ‰ä¸‹äº‹ä»¶
                searchBtn.addEventListener('mousedown', function(e) {
                    console.log('ğŸ–±ï¸ [ç´§æ€¥ä¿®å¤] æœç´¢æŒ‰é’®mousedown');
                    e.preventDefault();
                    window.triggerSearch();
                });
                
                // æ–¹æ³•3ï¼šè§¦æ‘¸äº‹ä»¶ï¼ˆç§»åŠ¨ç«¯ï¼‰
                searchBtn.addEventListener('touchstart', function(e) {
                    console.log('ğŸ“± [ç´§æ€¥ä¿®å¤] æœç´¢æŒ‰é’®touchstart');
                    e.preventDefault();
                    window.triggerSearch();
                });
                
                console.log('âœ… [ç´§æ€¥ä¿®å¤] æœç´¢æŒ‰é’®äº‹ä»¶ç»‘å®šå®Œæˆï¼ˆ3å±‚é˜²æŠ¤ï¼‰');
            }
            
            // Enteré”®è§¦å‘
            if (searchInput) {
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        console.log('âŒ¨ï¸ [ç´§æ€¥ä¿®å¤] Enteré”®è¢«æŒ‰ä¸‹');
                        e.preventDefault();
                        window.triggerSearch();
                    }
                });
            }
            
            // è¡¨å•æäº¤äº‹ä»¶ï¼ˆä½œä¸ºæœ€åçš„å…œåº•ï¼‰
            if (searchWrapper) {
                searchWrapper.addEventListener('submit', function(e) {
                    console.log('ğŸ“‹ [ç´§æ€¥ä¿®å¤] è¡¨å•submitäº‹ä»¶è§¦å‘');
                    e.preventDefault();
                    window.triggerSearch();
                });
            }
        });
        
        console.log('âœ… [ç´§æ€¥ä¿®å¤] è„šæœ¬åŠ è½½å®Œæˆ');
    </script>
    
    <script type="module" src="js/main.ts"></script>
    <!-- è€ç‹ä¿®å¤ï¼šService WorkeråŠŸèƒ½å·²æ¢å¤ï¼Œæ”¯æŒPWAç¦»çº¿ç¼“å­˜ -->
    <script>
        // æ³¨å†Œ Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('âœ… Service Worker æ³¨å†ŒæˆåŠŸ:', registration.scope);

                        // ç›‘å¬æ›´æ–°
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    console.log('ğŸ”„ æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬ï¼Œå¯ä»¥åˆ·æ–°é¡µé¢æ›´æ–°');
                                }
                            });
                        });
                    })
                    .catch(error => {
                        console.error('âŒ Service Worker æ³¨å†Œå¤±è´¥:', error);
                    });
            });
        }
    </script>
</body>
</html>
