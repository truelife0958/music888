
# 🎵 云音乐播放器

一个功能强大、现代化的在线音乐播放器,支持多平台音乐搜索、播放、下载和歌单管理。

## 📸 项目预览

### 桌面端界面
![桌面端界面](https://via.placeholder.com/1200x600/0c0c0c/ffffff?text=Desktop+View)

### 移动端界面
<img src="https://via.placeholder.com/375x667/0c0c0c/ffffff?text=Mobile+View" width="375">

> 💡 **提示**: 请将 `screenshots` 目录中的实际截图替换上方的占位图片

## ⚡ 性能指标

- 🚀 **首屏加载时间**: < 2s
- 📊 **Lighthouse 评分**: 95+
- 💾 **支持离线缓存**: 是
- 📱 **响应式设计**: 完美适配 320px - 2560px
- ♿ **可访问性**: WCAG 2.1 AA 标准
- 🎨 **动画性能**: 60fps 流畅体验

## ✨ 核心特性

### 🎼 多平台音乐源支持
- 🎧 **7个国内音乐平台**: 网易云音乐、QQ音乐、酷狗音乐、酷我音乐、虾米音乐、百度音乐、Bilibili音乐
- 🔄 **智能音乐源切换**: 版权保护时自动尝试其他平台
- 🎯 **动态优先级调度**: 根据成功率自动调整音乐源顺序
- 📊 **实时成功率统计**: 智能监控各音乐源可用性
- 🔍 **智能搜索**: 跨平台搜索您喜欢的歌曲
- 📡 **探索雷达**: 一键发现热门音乐
- 🎲 **随机播放**: 一键随机播放热门歌曲

### 🎚️ 播放功能
- ▶️ **高品质播放**: 支持标准(128K)、较高(192K)、高品质(320K)、无损(FLAC)、Hi-Res
- 🔄 **品质自动降级**: 当高品质不可用时,自动尝试更低品质,确保播放成功率
- 🎛️ **播放模式**: 列表循环、随机播放、单曲循环
- ⏮️ ⏭️ **上一曲/下一曲**: 流畅的播放控制
- 🔊 **音量控制**: 精细的音量调节
- 🛡️ **智能容错**: 连续失败保护,网络超时重试
- ⚡ **倍速播放**: 支持 0.5x - 2.0x 倍速调节
- 📱 **后台播放**: 支持锁屏播放和媒体控制

### 📝 歌词功能
- 📄 **实时歌词显示**: 同步显示歌词
- 💾 **歌词下载**: 下载 LRC 格式歌词文件
- 🎨 **歌词滚动**: 自动滚动到当前播放位置

### 📚 歌单管理
- 🔖 **解析网易云歌单**: 支持歌单ID或完整链接
- 💾 **保存歌单**: 本地保存您喜欢的歌单
- ❤️ **我的喜欢**: 收藏您最爱的歌曲
- 📜 **播放历史**: 自动记录最近播放的50首歌曲
- 📦 **批量操作**: 批量下载、批量收藏
- 🔄 **歌单管理**: 创建、编辑、删除自定义歌单

### 📥 下载功能
- ⬇️ **歌曲下载**: 下载高品质音乐文件
- 📜 **歌词下载**: 下载同步歌词文件
- 📦 **批量下载**: 一键下载整个歌单(最多50首)

### 🎨 用户体验
- 🌈 **精美界面**: 现代化的渐变背景和动画效果
- 📱 **三屏滑动**: 移动端支持左右滑动切换(内容区、播放器、我的)
- 🔔 **智能提示**: 详细的操作反馈和错误提示
- 💾 **本地存储**: 自动保存播放历史和收藏
- 🎯 **一键操作**: 折叠面板、快速清空等便捷功能
- ⌨️ **键盘快捷键**: 支持空格播放/暂停、方向键切换等
- 🌙 **自动主题**: 根据时间自动切换深色/浅色模式
- ⏰ **定时关闭**: 支持定时停止播放

## 🚀 快速开始

### 在线访问

🌐 **[在线演示](https://music.weny888.com/)** - 立即体验

### 一键部署到 Vercel

[![Deploy with Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https://github.com/truelife0958/music888)

点击上方按钮即可一键部署到 Vercel,完全免费!

#### 部署步骤:

1. **点击部署按钮** - 点击上方的 "Deploy with Vercel" 按钮
2. **登录 Vercel** - 使用 GitHub 账号登录 Vercel
3. **克隆仓库** - Vercel 会自动从 GitHub 克隆项目
4. **开始部署** - 点击 "Deploy" 按钮开始自动部署
5. **等待完成** - 通常 1-2 分钟即可完成部署
6. **访问网站** - 部署完成后会自动生成访问链接

### 本地运行

```bash
# 克隆项目
git clone https://github.com/truelife0958/music888.git

# 进入项目目录
cd music888

# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build
```

开发服务器启动后,访问 `http://localhost:5173`

## 📖 使用指南

### 搜索音乐
1. 在顶部搜索框输入歌曲名、歌手或专辑
2. 选择音乐平台(默认:网易云音乐)
3. 点击搜索按钮或按回车
4. 点击歌曲卡片开始播放

### 探索热门
1. 切换到"搜索结果"标签
2. 点击"探索雷达"按钮 - 系统自动推荐热门歌曲
3. 点击"随机播放全部"按钮 - 立即开始随机播放

### 管理播放历史与收藏
1. 切换到"我的"标签页(移动端向右滑动)
2. **播放历史**: 自动记录最近50首播放的歌曲
3. **我的喜欢**: 点击播放器的爱心按钮收藏歌曲
4. **快速清空**: 点击清空按钮可清除历史或收藏

### 解析歌单
1. 切换到"解析歌单"标签
2. 输入网易云歌单ID(如:`60198`)或完整链接
3. 点击"解析歌单"按钮
4. 支持保存、批量下载整个歌单

### 移动端操作
1. **左右滑动**: 在三个页面间切换(内容区 ← → 播放器 ← → 我的)
2. **页面指示器**: 底部圆点显示当前页面位置
3. **垂直滚动**: 已禁用,只保留左右滑动
4. **触摸优化**: 所有按钮都经过触摸优化

## ❓ 常见问题 (FAQ)

### Q: 为什么有些歌曲无法播放？
**A**: 可能的原因和解决方案：
- **版权限制**: 系统会自动尝试其他音乐平台
- **网络问题**: 检查网络连接，系统会自动重试
- **音乐源不可用**: 尝试切换到其他音乐平台搜索

### Q: 如何提高播放成功率？
**A**: 以下技巧可以提高播放成功率：
1. 选择较低品质（320K 或 192K）
2. 尝试不同音乐平台搜索
3. 检查网络连接稳定性
4. 避免播放过于冷门的歌曲

### Q: 移动端锁屏后音乐会停止吗？
**A**: 不会！支持：
- ✅ 息屏持续播放（Wake Lock API）
- ✅ 锁屏界面显示歌曲信息和控制按钮（Media Session API）
- ✅ 支持耳机线控和蓝牙设备控制

### Q: 如何使用键盘快捷键？
**A**: 支持以下快捷键：
- **空格**: 播放/暂停
- **←/→**: 上一曲/下一曲
- **↑/↓**: 音量增加/减少
- **M**: 播放模式切换
- **L**: 打开/关闭歌词面板

### Q: 数据会丢失吗？
**A**: 不会！所有数据都保存在浏览器本地存储（LocalStorage）中：
- 播放历史：最多保存 50 首
- 我的喜欢：无限制
- 保存的歌单：无限制

## 👨‍💻 技术架构

### 项目结构
```
music888/
├── api/                    # API 代理
│   ├── music-proxy.js     # 音乐API代理
│   └── bilibili-proxy.js  # Bilibili代理
├── css/                   # 样式文件
│   ├── style.css         # 主样式
│   ├── additions.css     # 附加样式
│   └── discover.css      # 发现音乐样式
├── js/                    # TypeScript 源码
│   ├── api.ts            # API 调用封装
│   ├── main.ts           # 主程序入口
│   ├── player.ts         # 播放器逻辑
│   ├── ui.ts             # UI 交互
│   ├── config.ts         # 配置文件
│   ├── utils.ts          # 工具函数
│   └── ...               # 其他功能模块
├── ncm-api/              # 网易云API服务
├── index.html            # 主页面
├── manifest.json         # PWA配置
├── service-worker.js     # Service Worker
├── package.json          # 项目配置
├── tsconfig.json         # TypeScript 配置
├── vite.config.ts        # Vite 配置
├── vercel.json           # Vercel 部署配置
└── README.md             # 项目说明

```

### 核心模块说明

#### 1. API 模块 (`api.ts`)
- **多音乐源管理**: 7个平台的智能切换
- **动态优先级**: 根据成功率自动调整顺序
- **容错机制**: 超时重试、URL验证、降级策略
- **统计监控**: 实时追踪各平台成功率

#### 2. Player 模块 (`player.ts`)
- **播放控制**: 播放/暂停、上一曲/下一曲
- **播放模式**: 列表循环、随机播放、单曲循环
- **历史管理**: 自动记录最近50首
- **收藏功能**: 本地存储用户喜欢的歌曲
- **批量操作**: 批量下载、批量收藏

#### 3. UI 模块 (`ui.ts`)
- **通知系统**: 成功/警告/错误提示
- **加载状态**: 骨架屏、加载动画
- **歌词显示**: 实时同步滚动
- **响应式布局**: 桌面/移动端适配

### 技术栈

**前端**:
- TypeScript - 类型安全
- Vite - 快速构建
- CSS3 - 现代样式
- Service Worker - PWA支持

**后端**:
- Vercel Serverless - 无服务器部署
- Node.js - API服务
- 多API源 - 高可用性

**存储**:
- LocalStorage - 本地数据持久化
- IndexedDB - 大数据存储(准备中)

## 🔧 开发指南

### 本地开发

```bash
# 安装依赖
npm install

# 启动开发服务器（热重载）
npm run dev

# 构建生产版本
npm run build

# 预览生产构建
npm run preview

# 类型检查
npm run type-check

# 运行测试
npm run test
```

### 代码规范

- **TypeScript**: 严格模式，完整类型注解
- **命名规范**: camelCase（变量/函数）、PascalCase（类型/接口）
- **注释**: 关键逻辑必须添加注释
- **错误处理**: 所有异步操作必须 try-catch

### 添加新音乐源

```typescript
// 1. 在 config.ts 中添加新的音乐源配置
export const AVAILABLE_SOURCES = [
    'netease', 'tencent', 'kugou', 'kuwo',
    'xiami', 'baidu', 'bilibili', 'your-new-source'
];

// 2. 在 api.ts 中实现获取方法
async function getYourNewSourceUrl(song: Song, quality: string) {
    // 实现获取逻辑
}
```

## 📋 更新日志

### v3.0.1 (2025-10-31) - 最新版本

#### 🎯 移动端优化
- ✅ **三屏滑动**: 支持左右滑动切换页面
- ✅ **禁用垂直滚动**: 移动端只保留左右滑动
- ✅ **触摸优化**: 优化触摸事件处理,防止内存泄漏
- ✅ **播放器优化**: 移动端播放器区域尺寸优化
- ✅ **显示修复**: 修复音质选择器和下载按钮显示问题

#### 🐛 BUG修复
- ✅ 修复批量收藏功能的存储键名错误
- ✅ 修复触摸事件监听器内存泄漏
- ✅ 修复艺术家信息显示 [object Object] 问题
- ✅ 优化歌词显示和滚动性能

#### 📦 项目整理
- ✅ 删除重复的优化文档
- ✅ 整合核心内容到README
- ✅ 保持代码纯净,移除无关文件

### v2.0.0 (2025-01-XX)

#### 🎯 核心功能增强
- ✅ **智能多音乐源切换**: 版权保护时自动尝试其他平台
- ✅ **动态优先级调度**: 根据实时成功率自动优化音乐源顺序
- ✅ **音乐源统计监控**: 每个平台成功率实时追踪

#### 🛡️ 容错性提升
- ✅ **网络超时优化**: 15秒超时+递增重试延迟
- ✅ **URL有效性验证**: 播放前检测链接
- ✅ **智能降级策略**: 自动降级到可用品质
- ✅ **连续失败保护**: 5首失败后自动暂停

#### 📚 歌单管理增强
- ✅ **播放历史记录**: 自动记录最近50首歌曲
- ✅ **收藏功能优化**: 修复播放器收藏按钮
- ✅ **批量操作**: 批量下载、批量收藏

### v1.0.0 (初始版本)
- 基础音乐播放功能
- 多平台搜索
- 歌单解析
- 品质选择

## 🎯 设计原则

本项目严格遵循软件工程最佳实践:

- **KISS (Keep It Simple, Stupid)**: 简洁的代码和设计
- **DRY (Don't Repeat Yourself)**: 避免代码重复
- **YAGNI (You Aren't Gonna Need It)**: 只实现必要的功能
- **SOLID原则**: 单一职责、开闭原则等

## 🐛 已知问题

- 部分歌单可能因版权限制无法解析
- 某些音乐平台的API可能不稳定
- 建议使用公开的歌单ID进行测试(如:`60198`, `3778678`, `2884035`)

## 🚀 未来计划

- [ ] IndexedDB大数据存储支持
- [ ] 音频均衡器和可视化
- [ ] 云端同步功能
- [ ] 社交分享功能
- [ ] 更多音乐平台支持
- [ ] 离线下载功能
- [ ] 智能推荐算法

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request!

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'feat: 添加某个功能'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 提交 Pull Request

### 提交规范

- `feat`: 新功能
- `fix`: 修复BUG
- `docs`: 文档更新
- `style`: 代码格式调整
- `refactor`: 代码重构
- `perf`: 性能优化
- `test`: 测试相关
- `chore`: 构建/工具链

## 📄 开源协议

本项目采用 MIT 协议 - 详见 [LICENSE](LICENSE) 文件

## 🙏 致谢

- [music-api.gdstudio.xyz](https://music-api.gdstudio.xyz) - 提供音乐API服务
- [Font Awesome](https://fontawesome.com/) - 提供图标库
- [Vite](https://vitejs.dev/) - 快速的构建工具
- 所有贡献者和使用者

## 📧 联系方式

- GitHub: [@truelife0958](https://github.com/truelife0958)
- Issues: [提交问题](https://github.com/truelife0958/music888/issues)
- 在线演示: [https://music.weny888.com/](https://music.weny888.com/)

## 📊 项目状态

![GitHub stars](https://img.shields.io/github/stars/truelife0958/music888?style=social)
![GitHub forks](https://img.shields.io/github/forks/truelife0958/music888?style=social)
![GitHub issues](https://img.shields.io/github/issues/truelife0958/music888)
![GitHub license](https://img.shields.io/github/license/truelife0958/music888)

---

⭐ 如果这个项目对您有帮助,请给个 Star 支持一下!

**享受音乐,享受生活!** 🎵✨
